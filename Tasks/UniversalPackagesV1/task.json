{
  "id": "e0b79640-8625-11e8-91be-db2878ff888a",
  "name": "UniversalPackages",
  "friendlyName": "Universal Packages",
  "description": "Download or publish Universal Packages",
  "author": "Microsoft Corporation",
  "helpUrl": "https://docs.microsoft.com/azure/devops/pipelines/tasks/package/universal-packages",
  "helpMarkDown": "[Learn more about this task](https://docs.microsoft.com/azure/devops/pipelines/tasks/package/universal-packages)",
  "category": "Package",
  "version": {
    "Major": 1,
    "Minor": 270,
    "Patch": 0
  },
  "runsOn": [
    "Agent",
    "DeploymentGroup"
  ],
  "minimumAgentVersion": "2.144.0",
  "instanceNameFormat": "Universal $(command)",
  "inputs": [
    {
      "name": "command",
      "type": "pickList",
      "label": "Command",
      "defaultValue": "download",
      "helpMarkDown": "The Universal Package command to run.",
      "required": "true",
      "properties": {
        "EditableOptions": "False"
      },
      "options": {
        "download": "Download",
        "publish": "Publish"
      }
    },
    {
      "name": "adoServiceConnection",
      "type": "connectedService:workloadidentityuser",
      "label": "Azure DevOps Service Connection",
      "required": false,
      "helpMarkDown": "Optional. The name of the Azure DevOps Service Connection to use. If not set, build identity is used."
    },
    {
      "name": "organization",
      "type": "string",
      "label": "Organization",
      "required": false,
      "helpMarkDown": "Optional. The Azure DevOps organization name where the feed is located (e.g., 'myorg' from dev.azure.com/myorg). Required when using a service connection for cross-organization access. When not specified, uses the current pipeline's organization."
    },
    {
      "name": "feed",
      "type": "string",
      "label": "Feed",
      "required": true,
      "helpMarkDown": "The feed name. For project-scoped feeds, use 'project/feed' format."
    },
    {
      "name": "packageName",
      "type": "string",
      "label": "Package name",
      "required": true,
      "helpMarkDown": "The name of the Universal Package. Package names must be lower case and can only use letters, numbers, and dashes (-)."
    },
    {
      "name": "packageVersion",
      "type": "string",
      "label": "Package version",
      "required": false,
      "helpMarkDown": "The version of the package. Required for download. For publish, either specify this or use 'versionIncrement' for auto-incrementing. For downloads, this can also be a wildcard expression such as * to get the highest version, 1.* to get the highest version with major version 1, or 1.2.* to get the highest patch release with major version 1 and minor version 2."
    },
    {
      "name": "versionIncrement",
      "type": "pickList",
      "label": "Version increment",
      "required": false,
      "helpMarkDown": "Cannot be used with 'packageVersion'. Automatically increment the package version. Queries the feed for the highest existing version and increments the specified component. For new packages, starts at 1.0.0 (major), 0.1.0 (minor), or 0.0.1 (patch).",
      "visibleRule": "command = publish",
      "options": {
        "major": "Major",
        "minor": "Minor",
        "patch": "Patch"
      }
    },
    {
      "name": "directory",
      "type": "filePath",
      "label": "Directory",
      "defaultValue": "$(System.DefaultWorkingDirectory)",
      "helpMarkDown": "For downloads: folder path where the package's contents will be downloaded. For publish: path to the directory containing files to publish.",
      "required": "true",
      "properties": {
        "EditableOptions": "True"
      }
    },
    {
      "name": "packageDescription",
      "type": "string",
      "label": "Description",
      "defaultValue": "",
      "helpMarkDown": "Optional. Description of the contents of this package and/or the changes made in this version of the package.",
      "required": "false",
      "visibleRule": "command = publish"
    },
    {
      "name": "verbosity",
      "type": "pickList",
      "label": "Verbosity",
      "defaultValue": "None",
      "helpMarkDown": "Specifies the amount of detail displayed in the output.",
      "required": "false",
      "options": {
        "None": "None",
        "Trace": "Trace",
        "Debug": "Debug",
        "Information": "Information",
        "Warning": "Warning",
        "Error": "Error",
        "Critical": "Critical"
      }
    }
  ],

  "execution": {
    "Node10": {
      "target": "universalMain.js",
      "argumentFormat": ""
    },
    "Node16": {
      "target": "universalMain.js",
      "argumentFormat": ""
    },
    "Node20_1": {
      "target": "universalMain.js",
      "argumentFormat": ""
    },
    "Node24": {
      "target": "universalMain.js",
      "argumentFormat": ""
    }
  },
  "messages": {
    "Debug_ArtifactToolPath": "Artifact tool path: %s",
    "Debug_CallingFeedApi": "Calling Feed API: %s",
    "Debug_CallingPermissionsApi": "Calling Permissions API: %s",
    "Debug_CalculatedVersion": "Calculated next version: %s",
    "Debug_DownloadOperation": "Download operation - Package: %s@%s, Target: %s",
    "Debug_Downloading": "Downloading package: %s, version: %s using feed id: %s, project: %s",
    "Debug_FeedFound": "Feed found - ID: %s, Project ID: %s",
    "Debug_FeedIdentityToken": "Feed identity token: %s",
    "Debug_GettingArtifactTool": "Getting artifact tool",
    "Debug_HighestPackageVersion": "Highest existing version found: %s",
    "Debug_NoProvenanceSession": "No provenance session available, using original feed ID",
    "Debug_OrgScopedFeed": "Organization-scoped feed detected - Feed: %s",
    "Debug_ParsedFeedInfo": "Parsed feed info - Service URI: %s, Feed: %s",
    "Debug_ProjectScopedFeed": "Project-scoped feed detected - Project: %s, Feed: %s",
    "Debug_ProvenanceApiUrl": "Creating provenance session at: %s",
    "Debug_ProvenanceDisabled": "Provenance disabled by Packaging.SavePublishMetadata variable",
    "Debug_ProvenanceResponseStatus": "Provenance API response status: %s",
    "Debug_PublishOperation": "Publish operation - Package: %s@%s, Source: %s",
    "Debug_Publishing": "Publishing package: %s, version: %s using feed id: %s, project: %s",
    "Debug_ResolvingVersionIncrement": "Resolving version increment: %s",
    "Debug_ResolvedPackagingUrl": "Resolved packaging service URL: %s",
    "Debug_RetrievingArtifactToolUri": "Retrieving artifact tool from: %s",
    "Debug_TelemetryInitFailed": "Unable to log Universal Packages task init telemetry. Err:( %s )",
    "Debug_TelemetryResultFailed": "Unable to log telemetry result. Err:( %s )",
    "Debug_UsingArtifactToolDownload": "Using artifact tool to download the package",
    "Debug_UsingArtifactToolPublish": "Using artifact tool to publish the package",
    "Debug_UsingBuildServiceCreds": "Using build service credentials for authentication",
    "Debug_UsingWifCreds": "Using WIF service connection credentials for authentication",
    "Debug_UsingProvenanceSession": "Using provenance session ID: %s",
    "Debug_UsingServiceUri": "Using service URI: %s",
    "Debug_UsingWifAuth": "Using WIF authentication with service connection: %s",
    "Debug_WifTokenObtained": "Successfully obtained WIF token for authentication",
    "Debug_DiscoveredTenant": "Discovered target tenant: %s",
    "Error_AuthenticationFailed": "Unable to authenticate for Universal Packages operations. Ensure the task runs in an Azure Pipelines build/release or provide a valid service connection.",
    "Error_CommandNotRecognized": "The command %s was not recognized.",
    "Error_FailedToGetArtifactTool": "Failed to get artifact tool. %s",
    "Error_InvalidVersionIncrement": "Invalid version increment value: %s. Expected 'major', 'minor', or 'patch'.",
    "Error_NoAuthToken": "Unable to obtain authentication token. The SYSTEMVSSCONNECTION endpoint is not configured correctly. Ensure this task runs in an Azure Pipelines build or release, or provide a service connection via the 'adoServiceConnection' input.",
    "Error_OrganizationRequired": "Organization is required when using a service connection for cross-organization access.",
    "Error_PackageVersionRequired": "Package version is required for download operations.",
    "Error_PackagesFailedToDownload": "Package failed to download",
    "Error_PackagesFailedToPublish": "Package failed to publish",
    "Error_UnexpectedErrorArtifactToolDownload": "An unexpected error occurred while trying to download the package. Exit code(%s) and error(%s)",
    "Error_UnexpectedErrorArtifactToolPublish": "An unexpected error occurred while trying to push the package. Exit code(%s) and error(%s)",
    "Error_UniversalPackagesNotSupportedOnPrem": "Universal Packages are not supported in Azure DevOps Server.",
    "Error_VersionInputRequired": "For publish operations, either 'packageVersion' or 'versionIncrement' must be specified.",
    "Error_VersionInputsMutuallyExclusive": "Cannot specify both 'packageVersion' and 'versionIncrement'. Please use only one.",
    "Info_UsingIncrementedVersion": "Using incremented version %s (%s increment from %s)",
    "Success_PackagesDownloaded": "Package was downloaded successfully",
    "Success_PackagesPublished": "Package was published successfully",
    "Warning_BuildIdentityFeedHint": "Check feed '%s' permissions: %s",
    "Warning_BuildIdentityOperationHint": "Operation failed using identity '%s' (%s).",
    "Warning_DownloadRequiresReaderAccess": "Downloading packages requires %s access. Downloading upstream packages requires %s or higher access.",
    "Warning_FeedDoesNotExist": "The feed '%s' does not exist.",
    "Warning_FeedInformationEmpty": "Unable to retrieve feed information from the server.",
    "Warning_FeedInformationUnavailable": "Unable to retrieve feed information. %s",
    "Warning_HasAccessToFeed": "%s has %s access to feed '%s'.",
    "Warning_NoPermissionsOnFeed": "%s has no permissions on feed '%s'.",
    "Warning_NotAuthorizedToAccessFeed": "%s is not authorized to access the feed '%s'.",
    "Warning_ProvenanceSessionFailed": "Provenance session creation failed: %s",
    "Warning_PublishRequiresContributorAccess": "Publishing packages requires %s or higher access.",
    "Warning_ServiceConnectionNotFound": "Service connection '%s' not found or not accessible. Falling back to build service token.",
    "Warning_UnableToDeterminePermissions": "Feed '%s' exists, but unable to determine permissions. %s",
    "Warning_UnableToDeterminePermissionsUnknown": "Feed '%s' exists, but unable to determine permissions.",
    "Warning_WifAuthFailed": "WIF authentication failed for service connection %s, falling back to build service token: %s",
    "Warning_WifAuthNoToken": "WIF authentication returned no token for service connection %s, falling back to build service token"
  }
}