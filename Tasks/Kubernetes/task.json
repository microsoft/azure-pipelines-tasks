{
    "id": "CBC316A2-586F-4DEF-BE79-488A1F503564",
    "name": "Kubernetes",
    "friendlyName": "Deploy to Kubernetes",
    "description": "Deploy of run a command on kubernetes cluster",
    "helpMarkDown": "[More Information](http://aka.ms/dockertoolsforvsts)",
    "category": "Build",
    "visibility": [
        "Build",
        "Release"
    ],
    "author": "Microsoft Corporation",
    "version": {
        "Major": 0,
        "Minor": 1,
        "Patch": 1
    },
    "demands": [],
    "preview": "true",
    "groups": [
        {
            "name": "registry",
            "displayName": "Container Registry Details",
            "isExpanded": true
        },
        {
            "name": "commands",
            "displayName": "Commands",
            "isExpanded": false
        },
        {
            "name": "output",
            "displayName": "Output",
            "isExpanded": false
        }
    ],
    "inputs": [
        {
            "name": "kubernetesServiceEndpoint",
            "type": "connectedService:kubernetes",
            "label": "Kubernetes Service Connection",
            "helpMarkDown": "Select a Kubernetes Service Connection."
        },
        {
            "name": "containerregistrytype",
            "type": "pickList",
            "label": "Container Registry Type",
            "defaultValue": "Azure Container Registry",
            "required": true,
            "options": {
                "Azure Container Registry": "Azure Container Registry",
                "Container Registry": "Container Registry"
            },
            "helpMarkDown": "Select a Container Registry Type.",
            "groupName": "registry"
        },
        {
            "name": "dockerRegistryEndpoint",
            "type": "connectedService:dockerregistry",
            "label": "Docker Registry Connection",
            "helpMarkDown": "Select a Docker registry connection. Required for commands that need to authenticate with a registry.",
            "visibleRule": "containerregistrytype = Container Registry",
            "groupName": "registry"
        },
        {
            "name": "azureSubscriptionEndpoint",
            "type": "connectedService:AzureRM",
            "label": "Azure subscription",
            "helpMarkDown": "Select an Azure subscription",
            "visibleRule": "containerregistrytype = Azure Container Registry",
            "required": true,
            "groupName": "registry"
        },
        {
            "name": "azureContainerRegistry",
            "label": "Azure Container Registry",
            "type": "pickList",
            "helpMarkDown": "Select an Azure Container Registry",
            "visibleRule": "containerregistrytype = Azure Container Registry",
            "required": true,
            "defaultValue": "",
            "groupName": "registry"
        },
        {
            "name": "secretName",
            "type": "string",
            "label": "Secret name",
            "required": false,
            "defaultValue": "",
            "helpMarkDown": "Secret name",
            "groupName": "registry"
        },
        {
            "name": "forceUpdate",
            "type": "boolean",
            "label": "Force Update secret",
            "defaultValue": "true",
            "helpMarkDown": "Recreate secret.",
            "groupName": "registry"
        },
        {
            "name": "command",
            "type": "pickList",
            "label": "Command",
            "defaultValue": "apply",
            "required": true,
            "options": {
                "apply": "apply",
                "create": "create",
                "delete": "delete",
                "exec": "exec",
                "expose": "expose",
                "get": "get",
                "logs": "logs",
                "run": "run",
                "set": "set",
                "top": "top"
            },
            "helpMarkDown": "Select a kubectl command.",
            "groupName": "commands",
            "properties": {
                "EditableOptions": "True"
            }
        },
        {
            "name": "useConfigurationFile",
            "type": "boolean",
            "label": "Use Configuration files",
            "defaultValue": "false",
            "helpMarkDown": "Use configuration file for the command.",
            "groupName": "commands"
        },
        {
            "name": "configuration",
            "type": "filePath",
            "label": "Configuration File",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Path to the Configuration file or directory.",
            "visibleRule": "useConfigurationFile = true",
            "groupName": "commands"
        },
        {
            "name": "arguments",
            "type": "multiLine",
            "properties": {
                "resizable": "true",
                "rows": "2"
            },
            "label": "Arguments",
            "helpMarkDown": "Command arguments",
            "groupName": "commands"
        },
        {
            "name": "cwd",
            "type": "filePath",
            "label": "Working Directory",
            "defaultValue": "$(System.DefaultWorkingDirectory)",
            "helpMarkDown": "Working directory for the Kubectl command.",
            "groupName": "commands"
        },
        {
            "name": "outputFormat",
            "type": "pickList",
            "label": "Output format",
            "defaultValue": "json",
            "required": false,
            "options": {
                "json": "json",
                "yaml": "yaml"
            },
            "helpMarkDown": "output file format.",
            "groupName": "output"
        },
        {
            "name": "kubectlOutput",
            "type": "string",
            "label": "Kubectl output",
            "required": false,
            "defaultValue": "",
            "groupName": "output",
            "helpMarkDown": "Name of the variable."
        }
    ],
    "dataSourceBindings": [
        {
            "target": "azureContainerRegistry",
            "endpointId": "$(azureSubscriptionEndpoint)",
            "dataSourceName": "AzureRMContainerRegistries",
            "resultTemplate": "{\"Value\":\"{\\\"loginServer\\\":\\\"{{{properties.loginServer}}}\\\", \\\"id\\\" : \\\"{{{id}}}\\\"}\",\"DisplayValue\":\"{{{name}}}\"}"
        }
    ],
    "instanceNameFormat": "kubectl $(command)",
    "execution": {
        "Node": {
            "target": "src//kubernetes.js"
        }
    },
    "messages": {
        "ContainerPatternFound": "Pattern found in dockerfilepath parameter",
        "ContainerPatternNotFound": "No pattern found in dockerfilepath parameter",
        "ContainerDockerFileNotFound":"No Docker file matching  %s  was found.",
        "DownloadingClient":"Downloading kubernetes client.",
        "CreatingSecret":"Executing create docker-registry %s secret.",
        "DeleteSecret": "Executing delete docker-registry %s secret"
    }
}