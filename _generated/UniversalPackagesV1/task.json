{
  "id": "e0b79640-8625-11e8-91be-db2878ff888a",
  "name": "UniversalPackages",
  "friendlyName": "Universal packages",
  "description": "Download or publish Universal Packages",
  "author": "Microsoft Corporation",
  "helpUrl": "https://docs.microsoft.com/azure/devops/pipelines/tasks/package/universal-packages",
  "helpMarkDown": "[Learn more about this task](https://docs.microsoft.com/azure/devops/pipelines/tasks/package/universal-packages)",
  "category": "Package",
  "version": {
    "Major": 1,
    "Minor": 270,
    "Patch": 0
  },
  "runsOn": [
    "Agent",
    "DeploymentGroup"
  ],
  "minimumAgentVersion": "4.248.0",
  "instanceNameFormat": "Universal $(command)",
  "inputs": [
    {
      "name": "command",
      "type": "pickList",
      "label": "Command",
      "defaultValue": "download",
      "helpMarkDown": "The Universal Package command to run.",
      "required": "true",
      "properties": {
        "EditableOptions": "False"
      },
      "options": {
        "download": "Download",
        "publish": "Publish"
      }
    },
    {
      "name": "feed",
      "type": "string",
      "label": "Feed",
      "required": true,
      "helpMarkDown": "The feed name. For project-scoped feeds, use 'project/feed' format."
    },
    {
      "name": "packageName",
      "type": "string",
      "label": "Package name",
      "required": true,
      "helpMarkDown": "The name of the Universal Package. Package names must be lower case and can only use letters, numbers, and dashes (-)."
    },
    {
      "name": "packageVersion",
      "type": "string",
      "label": "Package version",
      "required": false,
      "helpMarkDown": "The version of the package. Required for download. For publish, either specify this or use 'versionIncrement' for auto-incrementing. For downloads, this can also be a wildcard expression such as * to get the highest version, 1.* to get the highest version with major version 1, or 1.2.* to get the highest patch release with major version 1 and minor version 2."
    },
    {
      "name": "versionIncrement",
      "type": "pickList",
      "label": "Version increment",
      "required": false,
      "helpMarkDown": "Cannot be used with 'packageVersion'. Automatically increment the package version. Queries the feed for the highest existing version and increments the specified component. For new packages, starts at 1.0.0 (major), 0.1.0 (minor), or 0.0.1 (patch).",
      "visibleRule": "command = publish",
      "options": {
        "major": "Major",
        "minor": "Minor",
        "patch": "Patch"
      }
    },
    {
      "name": "directory",
      "type": "filePath",
      "label": "Directory",
      "defaultValue": "$(System.DefaultWorkingDirectory)",
      "helpMarkDown": "For downloads: folder path where the package's contents will be downloaded. For publish: path to the directory containing files to publish.",
      "required": "true",
      "properties": {
        "EditableOptions": "True"
      }
    },
    {
      "name": "packageDescription",
      "type": "string",
      "label": "Description",
      "defaultValue": "",
      "helpMarkDown": "Optional. Description of the contents of this package and/or the changes made in this version of the package.",
      "required": "false",
      "visibleRule": "command = publish"
    }
  ],
  "outputVariables": [
    {
      "name": "packageName",
      "description": "The name of the published package. Only set when command is 'publish'."
    },
    {
      "name": "packageVersion",
      "description": "The version of the published package. Only set when command is 'publish'. Especially useful with versionIncrement, where the version is computed at runtime."
    }
  ],
  "execution": {
    "Node20_1": {
      "target": "universalMain.js",
      "argumentFormat": ""
    },
    "Node24": {
      "target": "universalMain.js",
      "argumentFormat": ""
    }
  },
  "messages": {
    "Debug_ArtifactToolPath": "Artifact tool path: %s",
    "Debug_AuthenticatedIdentity": "Authenticated identity: %s (ID: %s)",
    "Debug_CalculatedVersion": "Calculated next version: %s",
    "Debug_CreatingLocationApi": "Creating location API client",
    "Debug_DiscoveredTenant": "Discovered target tenant: %s",
    "Debug_Downloading": "Downloading package: %s, version: %s using feed id: %s, project: %s",
    "Debug_FailedToGetFeedTenantId": "Failed to get the tenant ID for feed: %s. Error: %s",
    "Debug_FailedToGetIdentityInfo": "Failed to get authenticated identity info: %s",
    "Debug_FeedServiceUri": "Feed service URI (from location API): %s",
    "Debug_GettingArtifactTool": "Getting artifact tool",
    "Debug_GettingConnectionData": "Fetching connection data to identify authenticated user",
    "Debug_HighestPackageVersion": "Highest existing version found: %s",
    "Debug_NoProvenanceSession": "No provenance session available, using original feed ID",
    "Debug_OrgScopedFeed": "Organization-scoped feed detected - Feed: %s",
    "Debug_ParsedFeedInfo": "Parsed feed info - Service URI: %s, Feed: %s",
    "Debug_ProjectScopedFeed": "Project-scoped feed detected - Project: %s, Feed: %s",
    "Debug_ProvenanceApiUrl": "Creating provenance session at: %s",
    "Debug_ProvenanceDisabled": "Provenance disabled by Packaging.SavePublishMetadata variable",
    "Debug_ProvenanceResponseStatus": "Provenance API response status: %s",
    "Debug_Publishing": "Publishing package: %s, version: %s using feed id: %s, project: %s",
    "Debug_ResolvedPackagingUrl": "Resolved packaging service URL: %s",
    "Debug_ResolvingFeedServiceUri": "Resolving feed service URI anonymously from %s",
    "Debug_ResolvingVersionIncrement": "Resolving version increment: %s",
    "Debug_RetrievingArtifactToolUri": "Retrieving artifact tool from: %s",
    "Debug_SetOutputVariables": "Set output variables - packageName: %s, packageVersion: %s",
    "Debug_TelemetryInitFailed": "Unable to log Universal Packages task init telemetry. Err:( %s )",
    "Debug_TelemetryResultFailed": "Unable to log telemetry result. Err:( %s )",
    "Debug_UsingArtifactToolDownload": "Using artifact tool to download the package",
    "Debug_UsingArtifactToolPublish": "Using artifact tool to publish the package",
    "Debug_UsingBuildServiceCreds": "Using build service credentials for authentication",
    "Debug_UsingProvenanceSession": "Using provenance session ID: %s",
    "Debug_UsingServiceUri": "Using service URI: %s",
    "Debug_UsingWifAuth": "Using WIF authentication with service connection: %s",
    "Debug_WifTokenObtained": "Successfully obtained WIF token for authentication",
    "Error_AuthenticationFailed": "Unable to authenticate for Universal Packages operations. Ensure the task runs in an Azure Pipelines build/release or provide a valid service connection.",
    "Error_CommandNotRecognized": "The command %s was not recognized.",
    "Error_FailedToGetArtifactTool": "Failed to get artifact tool. %s",
    "Error_FailedToResolveFeedUri": "Failed to resolve feed service URI from %s: %s",
    "Error_FeedServiceUriNoLocationUrl": "Resource area response did not contain locationUrl",
    "Error_FeedServiceUriRequestFailed": "Failed to resolve feed service URI: %s %s",
    "Error_InvalidVersionIncrement": "Invalid version increment value: %s. Expected 'major', 'minor', or 'patch'.",
    "Error_NoAuthToken": "Unable to obtain authentication token. The SYSTEMVSSCONNECTION endpoint is not configured correctly. Ensure this task runs in an Azure Pipelines build or release, or provide a service connection via the 'adoServiceConnection' input.",
    "Error_PackageVersionRequired": "Package version is required for download operations.",
    "Error_PackagesFailedToDownload": "Failed to download package '%s' version '%s' from feed '%s'",
    "Error_PackagesFailedToPublish": "Failed to publish package '%s' version '%s' to feed '%s'",
    "Error_UnexpectedErrorArtifactToolDownload": "An unexpected error occurred while trying to download the package. Exit code(%s) and error(%s)",
    "Error_UnexpectedErrorArtifactToolPublish": "An unexpected error occurred while trying to push the package. Exit code(%s) and error(%s)",
    "Error_UnexpectedErrorFailedToGetToolMetadata": "Failed to get artifact tool metadata from source url %s",
    "Error_UniversalPackagesNotSupportedOnPrem": "Universal Packages are not supported in Azure DevOps Server.",
    "Error_VersionInputRequired": "For publish operations, either 'packageVersion' or 'versionIncrement' must be specified.",
    "Error_VersionInputsMutuallyExclusive": "Cannot specify both 'packageVersion' and 'versionIncrement'. Please use only one.",
    "Info_DownloadingArtifactTool": "Downloading artifact tool from %s",
    "Info_DownloadingPackage": "Downloading package '%s' version '%s' to '%s'",
    "Info_PublishingPackage": "Publishing package '%s' version '%s' from '%s'",
    "Info_ResolvePackageVersionRoute": "Resolved get highest package version route: %s",
    "Info_ResolvedToolFromCache": "Resolved from tool cache: %s",
    "Info_UsingIncrementedVersion": "Using incremented version %s (%s increment from %s)",
    "Success_PackagesDownloaded": "Successfully downloaded package '%s' version '%s' from feed '%s'",
    "Success_PackagesPublished": "Successfully published package '%s' version '%s' to feed '%s'",
    "Warning_BuildServiceIdentityHint": "Operation was attempted using the pipeline's build service identity: %s (%s). Ensure this identity has the required permissions on the feed.",
    "Warning_ProvenanceSessionFailed": "Provenance session creation failed: %s",
    "Warning_ServiceConnectionIdentityHint": "Operation was attempted using service connection '%s' with identity: %s (%s).",
    "Warning_WifAuthFailed": "WIF authentication failed for service connection '%s': %s",
    "Warning_WifAuthNoToken": "WIF authentication returned no token for service connection '%s'"
  },
  "_buildConfigMapping": {
    "Default": "1.270.0",
    "LocalPackages": "1.249.4",
    "wif_242": "1.270.0"
  }
}